<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Info windows</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      #body {
        margin: 0 auto;
        min-height: 100%;
        overflow: auto;
        padding-bottom: 95px;
      }

      .video-container {
        position:relative;
        padding-bottom:56.25%;
        padding-top:30px;
        height:0;
        overflow:hidden;
      }
      .footer {
        position: relative;
        margin-top: -95px;
        height: 95px;
        clear: both;
      }
    </style>
  </head>
  <body>
  <div class="jumbotron jumbotron-fluid">
    <div class="container">
      <h1 class="display-3">Decouvrir La Martinique</h1>
      <p class="lead">Carte illustrant l'ensemble des randonnees disponibles en Martinique.</p>
    </div>
  </div>
    <div id="body" class="container">
      <div class="row">
        <div class="col">
          <div id="map"></div>
        </div>
        <div class="col">
          <div class="">
            <div id="player"></div>
          </div>
          <div id="app-list">
            <div class="list-group">
              <a class="list-group-item list-group-item-action" 
              v-bind:class="[active === 'list-' + hiking.videoId ? 'active' : '']" 
              v-for="hiking in hikings" 
              v-bind:id="'list-' + hiking.videoId"
              v-on:click="toggleMarkerClick">
                <img width="28px" height="28px" src="img/triangle-right.svg" />
                {{ hiking.name }}
              </a>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="footer">
      <hr>
        <div class="container">
          <ul class="nav justify-content-center">
            <li class="nav-item">
              Decouvrir La Martinique
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><img width="28px" height="28px" src="img/globe.svg" /></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><img width="28px" height="28px" src="img/facebook.svg" /></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><img width="28px" height="28px" src="img/instagram.svg" /></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><img width="28px" height="28px" src="img/youtube.svg" /></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><img width="28px" height="28px" src="img/twitter.svg" /></a>
            </li>
          </ul>
        </div>
    </div>
    
    <script src="rando.js"></script>
    <script src="vue.min.js"></script>
    <script src="player.js"></script>
    <script>

      var hikingList = new Vue({
        el: '#app-list',
        data: {
          hikings: randos,
          active: 'list-' + randos[0].videoId
        },
        methods: {
          toggleMarkerClick: function(event) {
            var id = event.currentTarget['id'];
            this.$data.active = id;
            var videoId = id.replace('list-', '');
            player.loadVideoById(videoId);
          }
        }
      });

      function initMap() {
        var uluru = {lat: 14.641528, lng: -61.024174};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 11,
          center: uluru
        });

        google.maps.Marker.prototype.setVideoId = function(videoId) {
          this.videoId = videoId;
        };

        randos.forEach(function(hiking) {
          let marker = new google.maps.Marker({
            position: hiking.position,
            map: map,
            title: hiking.name,
            videoId: hiking.videoId
          });
          marker.addListener('click', function() {
            var player = YT.get('player');
            player.loadVideoById(marker.videoId);
            hikingList.$data.active = 'list-' + marker.videoId;
          });
        });
      }

      // function toggleMarkerClick() {
      //   var player = YT.get('player');
      //   player.loadVideoById(marker.videoId);
      //   debugger;
      //   // listEl.$el = document.getElementById('list-' + marker.videoId);
      //   // listEl.$data = {'isActive': true};
      // }

    </script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA6AYMK-E_4Iq0jXFx6Zpcl8JF2Qan6Afc&callback=initMap">
    </script>
  </body>
</html>